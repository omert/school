\documentclass[11pt]{article} \usepackage{amssymb}
\usepackage{amsfonts} \usepackage{amsmath} \usepackage{amsthm} \usepackage{bm}
\usepackage{latexsym} \usepackage{epsfig}

\setlength{\textwidth}{6.5 in} \setlength{\textheight}{8.25in}
\setlength{\oddsidemargin}{0in} \setlength{\topmargin}{0in}
\addtolength{\textheight}{.8in} \addtolength{\voffset}{-.5in}

\newtheorem*{theorem*}{Theorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{proposition*}{Proposition}

\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{example}[theorem]{Example}
%\newenvironment{proof}{\noindent \textbf{Proof:}}{$\Box$}

\newcommand{\ignore}[1]{}

\newcommand{\enote}[1]{} \newcommand{\knote}[1]{}
\newcommand{\rnote}[1]{}



% \newcommand{\enote}[1]{{\bf [[Elchanan:} {\emph{#1}}{\bf ]]}}
% \newcommand{\knote}[1]{{\bf [[Krzysztof:} {\emph{#1}}{\bf ]]}}
% \newcommand{\rnote}[1]{{\bf [[Ryan:} {\emph{#1}}{\bf ]]}}



\DeclareMathOperator{\Support}{Supp} \DeclareMathOperator{\Opt}{Opt}
\DeclareMathOperator{\Ordo}{\mathcal{O}}
\newcommand{\MaxkCSP}{\textsc{Max $k$-CSP}}
\newcommand{\MaxkCSPq}{\textsc{Max $k$-CSP$_{q}$}}
\newcommand{\MaxCSP}[1]{\textsc{Max CSP}(#1)} \renewcommand{\Pr}{{\bf
    P}} \renewcommand{\P}{{\bf P}} \newcommand{\Px}{\mathop{\bf P\/}}
\newcommand{\E}{{\bf E}} \newcommand{\Cov}{{\bf Cov}}
\newcommand{\Var}{{\bf Var}} \newcommand{\Varx}{\mathop{\bf Var\/}}

\newcommand{\bits}{\{-1,1\}}

\newcommand{\nsmaja}{\textstyle{\frac{2}{\pi}} \arcsin \rho}

\newcommand{\Inf}{\mathrm{Inf}} \newcommand{\I}{\mathrm{I}}
\newcommand{\J}{\mathrm{J}}

\newcommand{\eps}{\epsilon} \newcommand{\lam}{\lambda}

% \newcommand{\trunc}{\ell_{2,[-1,1]}}
\newcommand{\trunc}{\zeta} \newcommand{\truncprod}{\chi}

\newcommand{\N}{\mathbb N} \newcommand{\R}{\mathbb R}
\newcommand{\Z}{\mathbb Z} \newcommand{\CalE}{{\mathcal{E}}}
\newcommand{\CalC}{{\mathcal{C}}} \newcommand{\CalM}{{\mathcal{M}}}
\newcommand{\CalR}{{\mathcal{R}}} \newcommand{\CalS}{{\mathcal{S}}}
\newcommand{\CalV}{{\mathcal{V}}}
\newcommand{\CalX}{{\boldsymbol{\mathcal{X}}}}
\newcommand{\CalG}{{\boldsymbol{\mathcal{G}}}}
\newcommand{\CalH}{{\boldsymbol{\mathcal{H}}}}
\newcommand{\CalY}{{\boldsymbol{\mathcal{Y}}}}
\newcommand{\CalZ}{{\boldsymbol{\mathcal{Z}}}}
\newcommand{\CalW}{{\boldsymbol{\mathcal{W}}}}
\newcommand{\CalF}{{\mathcal{Z}}}
% \newcommand{\boldG}{{\boldsymbol G}}
% \newcommand{\boldQ}{{\boldsymbol Q}}
% \newcommand{\boldP}{{\boldsymbol P}}
% \newcommand{\boldR}{{\boldsymbol R}}
% \newcommand{\boldS}{{\boldsymbol S}}
% \newcommand{\boldX}{{\boldsymbol X}}
% \newcommand{\boldB}{{\boldsymbol B}}
% \newcommand{\boldY}{{\boldsymbol Y}}
% \newcommand{\boldZ}{{\boldsymbol Z}}
% \newcommand{\boldV}{{\boldsymbol V}}
\newcommand{\boldi}{{\boldsymbol i}} \newcommand{\boldj}{{\boldsymbol
    j}} \newcommand{\boldk}{{\boldsymbol k}}
\newcommand{\boldr}{{\boldsymbol r}}
\newcommand{\boldsigma}{{\boldsymbol \sigma}}
\newcommand{\boldupsilon}{{\boldsymbol \upsilon}}
\newcommand{\hone}{{\boldsymbol{H1}}}
\newcommand{\htwo}{\boldsymbol{H2}}
\newcommand{\hthree}{\boldsymbol{H3}}
\newcommand{\hfour}{\boldsymbol{H4}}


\newcommand{\sgn}{\mathrm{sgn}} \newcommand{\Maj}{\mathrm{Maj}}
\newcommand{\Acyc}{\mathrm{Acyc}}
\newcommand{\UniqMax}{\mathrm{UniqMax}}
\newcommand{\Thr}{\mathrm{Thr}} \newcommand{\littlesum}{{\textstyle
    \sum}}

\newcommand{\half}{{\textstyle \frac12}}
\newcommand{\third}{{\textstyle \frac13}}
\newcommand{\fourth}{{\textstyle \frac14}}

\newcommand{\Stab}{\mathbb{S}}
\newcommand{\StabThr}[2]{\Gamma_{#1}(#2)}
\newcommand{\StabThrmin}[2]{{\underline{\Gamma}}_{#1}(#2)}
\newcommand{\StabThrmax}[2]{{\overline{\Gamma}}_{#1}(#2)}
\newcommand{\TestFcn}{\Psi}

\renewcommand{\phi}{\varphi}

\begin{document}
\title{Coding Theory - Exercise 3}

 \author{Omer Tamuz, 035696574}
\maketitle

\begin{enumerate}
\item 
  \begin{enumerate}
  \item Let $v_0$ through $v_{n-1}$ be the nodes on the left side of $G$,
  and $u_0$ through $u_{n-1}$ the nodes on the right side of $G$. 
  Let a message $m$ be an element of $\mathbb{F}_{2^c}^{k/c}$.
  Let $x\in \{0,1\}^k$ be $m$'s binary representation, e.g. by coding
  sequentially each symbol in $m$ by $c$ bits.
  Let $y\in \{0,1\}^n$ be $x$'s encoding under $C$.
  For each $j$ from zero to $n$, 
  let $(v_{i_1},\ldots,v_{i_c})$ be the $c$ nodes which are neighbors 
  of $u_j$, and $(y_{i_1},\ldots,y_{i_c})$ be the binary
  encoding of $M_j\in \mathbb{F}_{2^c}$ (by the same scheme). Then $M\in \mathbb{F}_{2^c}^n$
  is a codeword of $C'$. 

  The message $m$ is an element of 
  $\mathbb{F}_{2^c}^{k/c}$, while the codeword $M$ is an element of
  $\mathbb{F}_{2^c}^n$, so $C'$ is a $(n,k/c,d)_{2^c}$ code.

  \item
  Let $y,y'\in \{0,1\}^n$ be the $C$-encoded binary representations of 
  distinct $m,m'\in \mathbb{F}_{2^c}^{k/c}$, respectively. Then by $C$'s definition, $y$ and $y'$
  differ by at least $\delta n$ bits. Let $S$ be the set of nodes on the left
  side of $G$ that correspond to those bits. Let $P$ be $S$'s neighbors.
  Then by the expander's definition, $|P|\geq\gamma\delta n$. This will be the number
  of nodes, $u_j$, where the codewords $M$ and $M'$ will differ in at
  least one place, and hence the distance will be at least $\gamma\delta n$.
  
  \end{enumerate}
\item
  \begin{enumerate}
  \item 
  Let $S$ be the set which defines $H'$. Let 
  $S^*=\{s|s\in S\;\;\mbox{or}\;\;s^{-1}\in S\}$. 
  Then an alternative definition of $A$ is that 
  $A_{xy}$ equals one if there exists
  $s\in S*$ s.t. $y=sx$, and zero otherwise. Let $\chi$
  be a character of $G$. Let $v$ be a vector s.t. $v_x=\chi(x)$. Then:
  \begin{eqnarray*}
      \sum_{y\in G}A_{xy}v_y&=&\sum_{y=sx,s\in S^*}\chi(y)
    \\ &=&\sum_{s\in S^*}\chi(sx)
    \\ &=&\sum_{s\in S^*}\chi(s)\chi(x)
    \\ &=&\left(\sum_{s\in S^*}\chi(s)\right)v_x.
  \end{eqnarray*}
  If we denote $\lambda = \sum_{s\in S^*}\chi(s)$, then
  we have proved that $v$ is an eigenvector of $A$ with eigenvalue $\lambda$.
  \item
  Let $\chi_a(x)=(-1)^{x\cdot a}$. Then:
  \begin{eqnarray*}
    \chi_a(xy)&=&(-1)^{(x+y)\cdot a}
    \\ &=& (-1)^{x\cdot a+y\cdot a}
    \\ &=& (-1)^{x\cdot a}(-1)^{y\cdot a}
    \\ &=& \chi_a(x)\chi_a(y)
  \end{eqnarray*}
  and hence $\chi_a$ is a character of $G$. The eigenvalues of $A$ are therefore,
  for each $a\in \mathbb{F}_2^k$ , 
  \begin{eqnarray*}
    \lambda_a&=&\sum_{s\in S^*}\chi_a(s)
    \\ &=& \sum_{s\in S^*}(-1)^{s\cdot a}
  \end{eqnarray*}
  Since in $\mathbb{F}_2^k$ each element is its own inverse, in this case $S^*=S$. Hence:
  \begin{eqnarray*}
    \lambda_a=\sum_{i=1}^n(-1)^{b_i\cdot a}
  \end{eqnarray*}
  If $a$ is a message, then its corresponding $C$ codeword $c$ is defined
  by $c_i=b_i\cdot a$. Therefore there is an eigenvalue for each codeword:
  \begin{eqnarray*}
    \lambda_c=\sum_{i=1}^n(-1)^{c_i}
  \end{eqnarray*}
  This also equals, for a codeword $c$, the number of ``0'' bits minus 
  the number of ``1'' bits:
  \begin{eqnarray*}
    \lambda_c=|\{i\::c_i=0\}|-|\{i\::c_i=1\}|
  \end{eqnarray*}
  or $n$ minus twice the hamming weight:
  \begin{eqnarray*}
    \lambda_c=n-2|c|
  \end{eqnarray*}

  \item
  The largest eigenvalue would correspond to a codeword with with minimal
  weight. Since this is a linear code, the all-zeros vector is a code word,
  and largest eigenvalue would be $n$. Since the pairwise distance is between
  $(\half-\epsilon)n$ and $(\half+\epsilon)n$, the second largest eigenvalue would be at most $n$
  minus twice the minimum weight of a non-zero codeword, which is 
  $(\half-\epsilon)n$, so that
  \begin{eqnarray*}
    \lambda_2= n-2|c_{\min}|\leq n-2(\half-\epsilon)n=2\epsilon n
  \end{eqnarray*}
  The least possible second eigenvalue would be:
  \begin{eqnarray*}
    \lambda_n= n-2|c_{\max}|\geq n-2(\half+\epsilon)n=-2\epsilon n
  \end{eqnarray*}
  which in absolute value is the same as $\lambda_2$, and hence the spectral
  gap would be at least $n-2\epsilon n$.
  \end{enumerate}
  \item
    \begin{enumerate}
    \item 
    Let $V_L$ be the vertices on the left and $V_R$ the vertices on the right.
    Let $P$ be the number of paths $(v_1,v_2,v_3)$ s.t. $v_1,v_3\in V_R$ are on the
    right and $v_2\in V_L$ is on the left. 


    The number of options for $v_1$ and $v_3$
    is each $l$. If $v_1=v_3$ then the number of options for $v_2$ is $t$,
    otherwise it is at most $m$, so that
    \begin{eqnarray}
      \label{eq:paths_upper}
      P\leq lt+l(l-1)m.
    \end{eqnarray}

    On the other hand, we may build the path by selecting a node $v_2\in V_L$,
    and then selecting two of its edges, and calling their other ends
    $v_1$ and $v_3$:
   \begin{eqnarray*}
      P&=&\sum_{v\in V_L}\deg(v)^2
      \\ &\geq&{1\over n}\left(\sum_{v\in V_L}\deg(v)\right)^2
      \\ &=&{1\over n}\left(\sum_{v\in V_R}\deg(v)\right)^2
      \\ &=&{1\over n}l^2t^2
    \end{eqnarray*}
    
    Combining this with Eq.~\ref{eq:paths_upper}, we have:
    \begin{eqnarray*}
      {1\over n}l^2t^2 &\leq& lt+l(l-1)m
      \\ {1\over n}lt^2 &\leq& t+(l-1)m
      \\ {1\over n}lt^2 &\leq& t+lm-m
      \\ {1\over n}lt^2 -lm &\leq& t-m
      \\ lt^2 - lmn &\leq& n(t-m)
      \\ l(t^2 - mn) &\leq& n(t-m)
      \\ l &\leq& {n(t-m)\over t^2 - mn}
    \end{eqnarray*}
    \item
    Let the $n$ nodes on the left side of $G$ represent the $n$ characters 
    in some message $M$, encoded with a code $C=(n,k,d)_q$ and having at most
    $e$ errors.  Let the $l$ nodes on the right
    represent all codewords $C$ which are compatible with $M$, that is, have
    at least $n-e$ characters in common with it. For each such codeword,
    select $t=n-e$ such characters, and set an edge between the codeword and the
    character. Since the distance of the code is $d$, the neighbor sets of no
    two codewords will be larger than $n-d$. Denote $m=n-d$. Under these
    definitions of $t$ and $m$, the condition $e<n-\sqrt{n(n-d)}$ translates
    to $t>\sqrt{mn}$, and the graph thus created is the same as the graph
    from (a). The result of (a) can then also be translated into a statement
    about $C$:
    \begin{eqnarray*}
      l &\leq& {n(t-m)\over t^2 - mn}
      \\ &\leq& {n(n-e-(n-d))\over t^2 - mn}
      \\ &\leq& {n(d-e)\over t^2 - mn}
      \\ &\leq& n(d-e)
      \\ &\leq& n^2
    \end{eqnarray*}

    and hence there are no more than $n^2$ such codewords.

    \item
      Let $\zeta$ be a fixed number below $0.005$.

      We construct a random code in $F_q^n$ by picking a series of random 
      codewords from the uniform distribution over the ball of 
      radius $e=n/2+\zeta n$, around zero. We prove below that with non-zero 
      probability (actually with probability approaching one for large 
      values of $n$) we will choose a code with distance $d\geq{3n\over 4}$
      and an exponential number of codewords, for a particular radius.

      Let $d={3n\over 4}$. Define $m$ by $m=n-d=n/4$. Then
      $e=n/2+\zeta n=n-\sqrt{nm}+\zeta n$, 
      $t=n-e=\sqrt{nm}-\zeta n$, and for $\zeta < 0.005$
       it holds that
      \begin{equation*}
        t=\sqrt{nm} - \zeta n > 0.99\sqrt{mn}.
      \end{equation*}

      Let $x$ be a random point, picked from the uniform distribution
      over $B(\vec{0},e)\subset F_q^n$. The probability of $x$ to be non-zero
      in its $i$'th coordinate is independent of $i$, by symmetry,
      and we denote it by $p_n$. Given $\epsilon>0$, as $n$ increases, 
      the probability that a codeword has less than $e-\epsilon n$ non-zero
      coordinates approaches zero, and therefore $p$ approaches 
      $e/n={1\over 2}+\zeta$:
      \begin{equation*}
        \lim_{n\to\infty}p_n=\half+\zeta.
      \end{equation*}

      Given that a codeword is non-zero, then again by symmetry each
      of the other $q-1$ symbols is equally likely. Hence, the probability
      that two codewords are equal in some coordinate is
      \begin{equation*}
        (1-p_n)^2+p_n^2{1\over q-1}=1-2p_n+p_n^2{q\over 1-q}
      \end{equation*}
      and the expected distance between them is
      \begin{equation*}
        \E[\mbox{dist}]=2p_nn-p_n^2{q\over q-1}n
      \end{equation*}
      as $n$ goes to infinity, this approaches
      \begin{eqnarray*}
        \lim_{n\to\infty}\E[\mbox{dist}] &=&  2{e\over n}n-{e^2\over n^2}{q\over q-1}n 
        \\ &=&2e-\left({e\over n}\right)^2{q\over q-1}n
        \\ &=&2\left(n/2+\zeta n\right)-\left({1\over 2}+\zeta\right)^2{q\over q-1}n
        \\ &=&n+2\zeta n-\left({1\over 4}+\zeta+\zeta^2\right){q\over q-1}n
        \\ &=&n+2\zeta n-\left({n\over 4}+\zeta n+\zeta^2n\right){q\over q-1}
      \end{eqnarray*}
      We assume now that ${q\over q-1}=1-\zeta$ (a '$>$' inequality would suffice). 
      Then:
      \begin{eqnarray*}
        \lim_{n\to\infty}\E[\mbox{dist}]&=& n+2\zeta n-
        \left({n\over 4}+\zeta n+\zeta^2n\right)(1-\zeta)
        \\ &=& n+2\zeta n-{n\over 4}-\zeta n-\zeta^2n+
        {\zeta n\over 4}+\zeta^2 n+\zeta^3n
        \\ &=& {3n\over 4}+{5\zeta n\over 4}+\zeta^3n
      \end{eqnarray*}

      As a consequence, for large enough $n$, 
      by the Chernoff bound the probability of the distance
      between two codewords to be below $d={3n\over 4}$ is 
      less than $\exp(-2\zeta^2n)$. Hence, if we choose $\exp(\half\zeta^2n)$ 
      random codewords
      for our code, there will be codes for which, by union bound, the number
      of codeword pairs of distance less than ${3n\over 4}$ would be lower
      than $\exp(\zeta^2n)\exp(-2\zeta^2n)=exp(-\zeta^2n)$, which goes to zero as $n$ goes
      to infinity. Hence, there exist codes with an exponential number
      of codewords within a ball of radius $e=\half n+\zeta n$, 
      with distance at least $d={3n\over 4}$ between codewords.

      This implies that the Johnson bound is tight.
    \end{enumerate}
  \item       

    Given a function $f$ as described in the question, let $G=(V_L,V_R,E)$ 
    be a bipartite graph. Let $|V_L|=q$, where
    each node $u_q\in V_L$ corresponds to an element of $F_q$. Let each node 
    $v_p\in V_R$ correspond to a distinct polynomial $p\in F_q[x]$ which agrees with
    $f$ in at least $0.34q$ elements of $F_q$. Let there be an edge between
    $u_q$ and $v_p$ iff $p$ agrees with $f$ on $q$. The size of $V_R$ is then
    the number of polynomials the question asks about.

    Because the degree of the polynomials is at most $q/9$, then
    two distinct polynomials cannot agree on more than $q/9$ elements   
    of $F_q$. Hence, the intersection of the neighbor sets of two 
    nodes of $V_R$ cannot be larger than $q/9$. 

    We can bound the number of paths $P$ of length three starting on the
    left and ending on the left, in a similar fashion to the previous 
    question. Let such a path be characterized by the triplet
    of vertices $(v_1,u,v_2)$. Then one way of choosing a path is
    to choose $v_1$ and $v_2$, and then choose $u$. If $v_1=v_2$, then
    there are at most $q$ possible choices for $u$. If $v_1\neq v_2$, then
    there are at most $q/9$ options:
    \begin{equation*}
      P\leq |V_R|q+|V_R|(|V_R|-1)q/9.
    \end{equation*}
    
    We may also build a path by choosing $u$ and then choosing two of
    its edges and calling their ends $v_1$ and $v_2$:

   \begin{eqnarray*}
      P&=&\sum_{u\in V_L}\deg(u)^2
      \\ &\geq&{1\over q}\left(\sum_{u\in V_L}\deg(u)\right)^2
      \\ &=&{1\over q}\left(\sum_{v\in V_R}\deg(v)\right)^2
      \\ &\geq&{1\over q}\left(\sum_{v\in V_R}0.66q\right)^2
      \\ &=&{1\over q}(0.66q)^2|V_R|^2
      \\ &=&0.66^2q|V_R|^2
    \end{eqnarray*}

   We now have
   \begin{equation*}
     0.66^2q|V_R|^2\leq P\leq |V_R|q + |V_R|(|V_R|-1)q/9.
   \end{equation*}
   Hence
   \begin{eqnarray*}
     0.66^2q|V_R|^2&\leq& |V_R|q + |V_R|(|V_R|-1)q/9
     \\ 0.66^2|V_R|&\leq& 1 + (|V_R|-1)1/9
     \\ 9\cdot0.66^2|V_R|&\leq& 9 + |V_R|-1
     \\ 9\cdot0.66^2(|V_R|-1)&\leq& 8
     \\ |V_R|-1&\leq& {8\over 9\cdot0.66^2}
     \\ |V_R|&\leq& {8\over 9\cdot0.66^2}+1
   \end{eqnarray*}
   
   and the number of polynomials is indeed bounded by a constant.
\end{enumerate}
\end{document}




% 03-643-6205
